---
title: "Clone Stripe pricing"
description:
  "Replicate Stripe's per-transaction pricing model with Lago."
---

Implement a per-transaction pricing model like Stripe, the leading payments infrastructure company, including fees based on the total amount and number of transactions.

In this article, you will learn how to build a per-transaction billing system with Lago, where a single event can trigger instant charges.
This template is suitable for companies whose pricing depends on transactions, such as fintechs and marketplaces that deduct their fees from their customers' revenue.

<iframe width="560" height="315" src="https://www.youtube.com/embed/SBc7eB3T0rE?si=EAmRNU92Bgrh7w_B&amp;start=62" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

## Pricing structure
Stripe offers "pay-as-you-go" pricing based on successful card charges processed via its platform. 
Stripe's API includes many payment options. Rates and fixed fees per transaction vary depending on the payment method.

| Payment Method                  | Percentage Charge (based on transaction amount) | Fixed Fee (per transaction) |
|---------------------------------|--------------------------------------------------|-----------------------------|
| Card payments (online)          | 2.9%                                             | $0.30                       |
| Card payments (in-person)       | 2.7%                                             | $0.05                       |

As Stripe supports more 20 payment methods in the US and most of them share the same charge model, we will focus on card payments.

## Get started

<Steps>
  <Step title="Create a billable metric">
    Create a billable metric to track transaction usage for each payment method.
    
    Refer to the [API reference](/api-reference/billable-metrics/create) to create the billable metric object.

    1. Set the `aggregation_type` to `sum_agg`
    2. Set the `field_name` to `amount`
    3. Set the `filters` to:
    ```json
    [
      {
        "key": "type",
        "values": ["online", "in-person"]
      }
    ]
    ```

    Refer to the [guide on billable metrics](/guides/billable-metrics/overview) to learn more.
  </Step>
  <Step title="Create a plan with percentage pricing">
    Create a plan with percentage-based charges that are paid in advance.

    Refer to the [API reference](/api-reference/plans/create) to create the plan object.

    1. Set the `amount_cents` to `0` since there is no subscription fee
    2. Set the `charges` to:
    ```json
    [
      {
        "invoice_display_name": "Online Card Payment",
        "charge_model": "percentage",
        "pay_in_advance": true,  // for instant charging
        "invoiceable": false,    // no invoice per transaction
        "properties": {
          "rate": "2.9",         // 2.9% of transaction amount
          "fixed_amount": "0.30" // $0.30 fixed fee per transaction
        }
      },
      {
        "invoice_display_name": "In-person Card Payment",
        "charge_model": "percentage",
        "pay_in_advance": true,
        "invoiceable": false,
        "properties": {
          "rate": "2.7",
          "fixed_amount": "0.05"
        }
      }
    ]
    ```

    Refer to the [guide on percentage charges](/guide/plans/charges/charge-models/percentage) to learn more.
  </Step>
  <Step title="Ingest transactions in real-time">
    Send transaction events to Lago for instant processing and charging.

    ```bash
    LAGO_URL="https://api.getlago.com"

    curl --location --request POST "$LAGO_URL/api/v1/events" \
      --header 'Authorization: Bearer __API_KEY__' \
      --header 'Content-Type: application/json' \
      --data-raw '{
        "event": {
          "transaction_id": "{{$randomUUID}}",
          "code": "__BILLABLE_METRIC_CODE__",
          "external_customer_id": "__EXTERNAL_CUSTOMER_ID__",
          "properties": {
            "amount": 200
          }
        }
      }'
    ```

    Refer to the [API reference](/api-reference/events/usage) to create an event.
  </Step>
  <Step title="Estimate fees for future transactions">
    Calculate transaction fees before processing to show users expected costs.

    ```bash
    LAGO_URL="https://api.getlago.com"

    curl --location --request POST "$LAGO_URL/api/v1/events/estimate_fees" \
      --header 'Authorization: Bearer __API_KEY__' \
      --header 'Content-Type: application/json' \
      --data-raw '{
        "event": {
          "external_subscription_id": "__EXTERNAL_SUBSCRIPTION_ID__",
          "code": "__BILLABLE_METRIC_CODE__",
          "properties": {
            "amount": 1200
          }
        }
      }'
    ```

    Refer to the [API reference](/api-reference/events/estimate-fees) to learn more.
  </Step>
</Steps>

## Wrap-up
For fintech companies like Stripe, implementing a per-transaction pricing model is a good way to **increase revenue as customers grow and capture value everytime a transaction is processed**.
With Lago, you can create your own billable metrics and use the percentage charge model paid instantly to adapt this template to your products and services.

Give it a try, click [here](https://www.getlago.com/get-started) to get started!